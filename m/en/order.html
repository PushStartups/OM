<!DOCTYPE html>
<html lang="en" xmlns="http://www.w3.org/1999/xhtml">

<head>

    <meta charset="utf-8" />
    <title></title>

    <link href="/m/en/style/style.css" rel="stylesheet" />
    <link href="/m/en/style/dropdown.css" rel="stylesheet" />
    <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1, user-scalable=0" />
    <link href="https://maxcdn.bootstrapcdn.com/font-awesome/4.7.0/css/font-awesome.min.css" rel="stylesheet">
    <script src="/m/en/script/jquery.min.js"></script>
    <script type="text/javascript" src="/m/en/script/jquery.accordion.js"></script>
    <script src="/m/en/script/dropdown.js"></script>
    <script src="/m/en/script/app.js"></script>
    <script src="/m/en/script/commonAjaxCall.js"></script>
    <script type="text/javascript" src="/m/en/script/ajaxServerRequestsOrder.js"></script>

</head>

<body>


<header>

    <img id="ic_back" src="/m/en/img/back_arrow.png" onclick="backButton()">
    <img id="ic_logo" src="/m/en/img/bg_logo.png" onclick="backButton()">
    <span id ='restName' > Res Name </span>
    <img id="ic_cart" onclick="showCartElements(); updateCartElements();" src="/m/en/img/shopping-cart.png">
    <div style="display: none" onclick="showCartElements(); updateCartElements();" class="count-badge">
        0
    </div>

    <script>

        function backButton() {

            var selectedCityName  = JSON.parse(localStorage.getItem("USER_CITY_NAME"));

            if(selectedCityName != null)
            {
                selectedCityName = selectedCityName.replace(/\s/g, '');
                window.location.href = '/m/en/restaurants/'+selectedCityName;
            }
            else
            {
                window.location.href = '/m/en';
            }

        }

    </script>

</header>



<img id="loader" class="loader-css" src="/m/en/img/loader.gif" >


<div id="cards" style="height: calc(100% - 85px); width: 100%; overflow: hidden; overflow-y: auto">
    <div class="accordion-holder">
        <ul class="accordion multilevel-accordion" id="categories_list">
        </ul>
    </div>
</div>


<div id="overlay"></div>


<!--ORDER SUMMARY DETAIL POPUP (FOOD CART)-->

<div id="food-cart-popup" style="display: none;  bottom: 10px; height: calc(100% - 20px);" class="food-cart">

    <header>
        <img class="ic_close" src="/m/en/img/ic_close_white.png">
        <h5> FOOD CART </h5>
        <h2 id="totalAmount"> 0 NIS </h2>
    </header>

    <section id="orderItems">

    </section>

    <div class="model-footer" onclick="OnOrderNowClicked();" >PLACE ORDER</div>
</div>


<!-- CUSTOMER INFO POPUP-->
<div id="customer-popup"  class="food-cart">
    <header>
        <img class="ic_close" onclick="hidePopup('customer-popup')" src="/m/en/img/ic_close_white.png">
        <h5> CUSTOMER INFO </h5>
        <h2 class="totalBill"> 0 NIS </h2>
    </header>

    <section style="overflow: hidden">
        <div id="scroll-sec" class="inner-section" style="overflow-y: auto">
            <div class="caption-input">
                <span class="caption"> Name </span>
                <input id="name" type="text">
                <span class="error-handler" id="name-error"></span>
                <script>

                    // WHEN NAME FIELD CHANGES
                    $('#name').bind('input', function() {
                        document.getElementById("name-error").innerHTML = "";
                        $("#name").removeClass("red-border");

                    });

                </script>
            </div>
            <div class="caption-input" style="margin-top: 20px">
                <span class="caption"> Email address </span>
                <input id="email" type="text">
                <span class="error-handler" id="email-error"></span>
                <script>
                    // WHEN EMAIL FIELD CHANGES
                    $('#email').bind('input', function() {

                        document.getElementById("email-error").innerHTML = "";
                        $("#email").removeClass("red-border");

                    });
                </script>
            </div>
            <div class="caption-input" style="margin-top: 20px">

                <span class="caption"> Phone Number </span>
                <input id="contact" class="scroll2"  type="text">
                <span class="error-handler"  id="contact-error"></span>
                <script>

                    // WHEN EMAIL FIELD CHANGES
                    $('#contact').bind('input', function() {

                        document.getElementById("contact-error").innerHTML = "";
                        $("#contact").removeClass("red-border");


                    });

                </script>

            </div>
            <ul class="checkbox-list">
                <li>
                    <input type="radio" name="a" id="checkbox-id11" /> <label for="checkbox-id11">
                    Pick up from resturent

                    <div id="restAddress" style="white-space: normal !important;width: 174px;"></div>
                </label>
                </li>
                <li id="bottom-border">
                    <input type="radio"  name="a" id="checkbox-id12" /> <label for="checkbox-id12">
                    Delivery
                    <br>
                    <div class="caption-input" style="margin-top:0px">
                        <input type="text" class="scroll"  id="address"/>

                        <script>
                            $('#address').on('input',function(e){

                                if($("#address").val() != "")
                                {
                                    $("#checkbox-id12").prop('checked', true);
                                }
                                else
                                {
                                    $("#checkbox-id12").prop('checked', false);
                                }
                            });
                        </script>

                    </div>

                </label>
                </li>
                <script>
                    $(document).ready(function() {
                        $('input[type=radio][name=a]').change(function() {
                            document.getElementById("checkbox-error").innerHTML = "";
                            document.getElementById("address-error").innerHTML = "";
                        });

                    });

                    $('#checkbox-id11').click(function(){

                        if($('#checkbox-id11').is(':checked'))
                        {
                            $("#address").val("");
                        }
                    });


                </script>
                <li>
                    <span class="error-handler" id="address-error"></span>
                    <span class="error-handler" id="checkbox-error"></span>
                </li>

                <li>
                    <input type="checkbox" id="checkbox-id13"  /> <label for="checkbox-id13">
                    Coupon code
                    <div>Use coupon code</div>
                </label>
                </li>
            </ul>
        </div>

        <div style="position: absolute;bottom: 3px;width: 94.5%;" class="model-footer" onclick="takeNameAndEmail()" >Next</div>
    </section>
</div>



<!--TAKE COUPON NUMBER -->
<div id="coupon-popup" style="display: none" class="food-cart">

    <header>
        <img class="ic_close"  src="/m/en/img/ic_close_white.png">
        <h5> COUPON CODE </h5>
        <h2 class="totalBill"> 81 NIS </h2>
    </header>


    <section>
        <div style="border-radius: 0" class="inner-section">
            <div class="centered-div">
                <h3> ENTER COUPON CODE </h3>
                <input id="coponInput" type="text" />
                <span id="couponError" style="font-size: 8px; color: red"></span>
            </div>
            <a onclick="goToPaymentChoice(); hideCoupon()"> <b>Skip</b> </a>
        </div>


        <div id="coupon-footer" onclick="CheckCouponFromServer()"  class="model-footer">Next</div>

    </section>

</div>


<!--DISPLAY COUPON RESULT -->
<div id="check-coupon-popup"  class="food-cart" style="display: none; border-radius: 0px;">
    <header>
        <img class="ic_close" src="/m/en/img/ic_close_white.png">
        <h5> COUPON CODE </h5>
        <h2 class="totalBill"> 81 NIS </h2>
    </header>

    <section>
        <div class="inner-section">
            <div class="centered-div">
                <h3> YOUR COUPON CODE </h3>
                <input  id="code" type="text" />
            </div>
            <table style="width:100%; margin-top:20px">
                <tr>
                    <td>Sub total</td>
                    <td id="oldTotal">80 NIS</td>
                </tr>
            </table>

            <table style="width:100%;">
                <tr>
                    <td>Coupon</td>
                    <td id="discountAmount">-20</td>
                </tr>
            </table>

            <table style="width:100%;">
                <tr>
                    <td>Total</td>
                    <td id="newTotal">60 NIS</td>
                </tr>
            </table>
        </div>
        <div id="confimed-footer"  class="model-footer">Next</div>
    </section>
</div>

<!--PAYMENT CHOSE POPUP-->
<div id="payment-choice-popup" style="display: none" class="food-cart">
    <header>
        <img class="ic_close" src="/m/en/img/ic_close_white.png">
        <h5> CUSTOMER INFO </h5>
        <h2 class="totalBill"> 0 NIS </h2>
    </header>

    <section>
        <div class="inner-section">
            <table>
                <tr>
                    <td>
                        <div onclick="goToConfirmOrder(); confirmOrder('cash')" class="choice">
                            <span>CASH</span>
                        </div>
                    </td>

                </tr>
                <tr>
                    <td>
                        <div onclick="goToCards()" class="choice">
                                <span>
                                    CREDIT
                                    CARD
                                </span>
                        </div>
                    </td>
                </tr>
            </table>
        </div>

    </section>
</div>


<!--STRIPE CLIENT SIDE -->

<div id="creditcard-info-popup" style="display: none" class="food-cart">
    <header style="line-height: 20px;">
        <img style=" width: 40px;position: absolute;left: 0px;top: 0px;padding: 12px;"  onclick="$('#creditcard-info-popup').slideUp(); $('#payment-choice-popup').slideDown();" src="/m/en/img/ic_close_white.png">
        <h5> PAYMENT INFO </h5>
        <h2 style="margin-bottom: 7px;padding-bottom:5px" class="totalBill"> 0 NIS </h2>
    </header>
    <form name="payment-form" id="payment-form" style="height:100%"  method="POST">

        <section id="creditSection" style="overflow: auto; min-height: 300px;">

            <div style="padding: 8px 15px; border-radius: 0;height: calc(100% - 42px);" class="inner-section" >
                <div id="type-of-card">
                    <p>Type of card </p>
                    <span class="active">
                        <img src="/m/en/img/ic_visa.png">
                    </span>
                    <span>
                        <img src="/m/en/img/2.png">
                    </span>
                    <span>
                        <img src="/m/en/img/3.png">
                    </span>
                </div>

                <div class="caption-input" style="margin-top: 13px; margin-bottom: 15px;">
                    <span class="caption"> Name on card </span>
                    <input style="line-height: 20px;" type="text" id="user_name" value="" size="20">
                </div>


                <div class="caption-input">
                    <span class="caption"> Card number </span>
                    <img src="/m/en/img/ic_visa.png">
                    <input maxlength="16" class="scroll2" style="line-height: 20px;" type="text" id="card_no" value="" size="20" data-stripe="number">
                    <span style="color: red" class="error_card_num add-font"></span>
                    <!--VALIDATE CARD NUMBER-->
                    <script>
                        $('#card_no').bind('input', function() {
                            //alert($("#price").val());

                            document.getElementsByClassName("error_card_num")[0].innerHTML = "";
                            $("#card_no").removeClass("red-border");
                            if((!this.value.match(/^\d+$/)))
                            {
                                if($("#card_no").val() == ''){

                                    $("#card_no").removeClass("red-border");
                                    document.getElementsByClassName("error_card_num")[0].innerHTML = "";
                                }else {
                                    $("#card_no").addClass("red-border");
                                    document.getElementsByClassName("error_card_num")[0].innerHTML = "Invalid Card Number!";
                                }
                            }
                            else
                            {
                                $("#card_no").removeClass("red-border");
                            }
                        });
                    </script>
                </div>


                <table style="border-bottom:unset; width:100%">
                    <tr>
                        <td style="width:50%" >
                            <div class="caption-input" style="margin-top: 10px">
                                <div class="form-row">
                                    <label>
                                        <span style="width: 100%; font-size:11px; display:block">Expiration (MM/YY)</span>
                                        <input style="width: 25%; line-height: 20px;" id="month"  type="number" size="2" data-stripe="exp_month">
                                        <script>
                                            $('#month').bind('input', function(e) {
                                                //alert($("#price").val());
                                                if ($(this).val() > 12) {
                                                    e.preventDefault();
                                                    $(this).val(12);

                                                }
                                            });
                                        </script>
                                    </label>
                                    <span> / </span>
                                    <input  maxlength="2" class="scroll2" style="width: 25%;  line-height: 20px;" id="year" type="number" size="2" data-stripe="exp_year">
                                    <script>
                                        $('#year').bind('input', function(e) {
                                            //alert($("#price").val());


                                            $("#year").removeClass("red-border");

                                            if ($(this).val() > 99) {
                                                e.preventDefault();
                                                $(this).val(17);

                                            }


                                        });
                                    </script>
                                </div>
                            </div>
                        </td>
                        <td style="width:50%" >
                            <div class="caption-input" style="margin-top: 10px">
                                <span class="caption"> cvv </span>
                                <img src="/m/en/img/ic_cvs.png">
                                <input class="scroll2"  style="line-height: 20px; border-bottom:1px solid #FEBEBC" size="4" data-stripe="cvc">
                            </div>
                        </td>
                    </tr>
                    <span style="color: red;font-size: 10px;" class="payment-errors"></span>

                </table>

                <div class="form-row" style="display: none">
                    <label>
                        <span>Billing ZIP Code</span>
                        <input type="text" size="6" data-stripe="address_zip" value="5">
                    </label>
                </div>

            </div>

            <div onclick="$('#payment-form').submit();"  class="model-footer">Next</div>

        </section>

    </form>

</div>

<!--STRIPE PAYMENT -->
<script>

    $(document).ready(function() {

        $("#payment-form").submit(function(e){

            addLoading();

            var $form = $('#payment-form');

            // Request a token from Stripe:
            Stripe.card.createToken($form, stripeResponseHandler);

            e.preventDefault(e);
            return false;
        });

        function stripeResponseHandler(status, response) {
            // Grab the form:
            var $form = $('#payment-form');

            if (response.error) { // Problem!

                // Show the errors on the form:
                $form.find('.payment-errors').text(response.error.message);

                console.log(response.error.message);

                hideLoading();

            }
            else
            { // Token was created!

                // Get the token ID:
                var token = response.id;

                console.log(token);

                payment_credit_card(token);


            }
        };

    });


</script>
<!--STRIPE PAYMENT ENDS-->




<!--CONFIRM ORDER POPUP-->
<div id="confirm-order-popup" style="" class="food-cart">
    <header>
        <img class="ic_close" onclick="hidePopup('confirm-order-popup')" src="/m/en/img/ic_close_white.png">
        <h5> CONFIRM ORDER </h5>
        <h2 class="totalBill"> 0 NIS </h2>
    </header>

    <section>
        <div class="inner-section">

            <div class="table-card">
                <table>
                    <tr>
                        <td>
                            <img style="width: 80%;" src="/m/en/img/ic_notifi.png">
                        </td>
                        <td>
                            <div class="orange-haeding"  id="all_orders_str">
                            </div>
                        </td>
                    </tr>
                </table>
            </div>

            <div class="table-card">
                <table>
                    <tr>
                        <td>
                            <img style="width: 80%;" src="/m/en/img/ic_location.png">
                        </td>
                        <td>
                            <div class="orange-haeding" id="userProvidedInfo">
                            </div>
                        </td>
                    </tr>
                </table>
            </div>

            <div class="table-card" id="couponParent">
                <table>

                    <tr>
                        <td>
                            <img  style="width: 80%;" src="/m/en/img/ic_gift.png">
                        </td>
                        <td>
                            <div class="orange-haeding" id="coupon_detail">
                            </div>
                        </td>
                    </tr>
                </table>
            </div>

            <div class="table-card">
                <table>
                    <tr>
                        <td>
                            <img style="width: 80%;" src="/m/en/img/ic_card.png">
                        </td>
                        <td>
                            <div class="orange-haeding" id="payment_choice">
                            </div>
                        </td>
                    </tr>
                </table>
            </div>

        </div>

        <div id="confirm-footer" onclick="callPage3()"  class="model-footer" > Next</div>

    </section>
</div>



<div id="footer-dots" >
    <span id="first-dot" class="active" > </span>
    <span id="second-dot" > </span>
    <span id="third-dot" > </span>
    <span id="fourth-dot" > </span>
    <span id="fifth-dot" > </span>
</div>




<!--ON ITEM SELECTED POPUP-->
<div id="main-popup" class="popup">

    <div class="body" id="scroll_error" style="overflow: hidden; overflow-y: auto;">

        <img class="ic_close" style="position: relative ; left: -25px;top: -9px;" src="/m/en/img/ic_close.png">

        <!--<div id="top-half">-->
        <h3 id="itemPopUpTitle" style="margin-top: -30px"></h3>

        <br>

        <div align="center" class="product-circle">
            <div class="product-circle">
                <div class="circle" style="background-image: url('/m/en/img/Image.png') ; display: none" ></div>
            </div>
            <div id="itemPopUpPrice" class="circle-badge"> 0 NIS </div>
        </div>

        <p class="para-detail" id="itemPopUpDesc"></p>

        <div class="sperator"></div>
        <!--</div>-->

        <div id="mid-scroll">
            <!--PARENT TO DISPLAY ON TYPE SUB ITEMS -->
            <div id="parent_type_one"></div>

            <!--PARENT TO DISPLAY MULTIPLE TYPE SUB ITEMS-->
            <div id="parent_type_multiple"></div>
        </div>

    </div>

    <div onclick="addUserOrder();" class="model-footer">ADD TO MY ORDER</div>

</div>



<div id="error_alert" style="width: 80%;text-align: center;box-shadow: 0 0 20px black; border-radius: 10px; position: absolute; top: 50%; left: 50%; padding: 30px; background: white; transform: translate(-50%,-50%)">
    <img style="width: 45px; padding: 14px; position: absolute; left: 0px; top: 0px; " src="/m/en/img/ic_close.png">
    <span id="min_order"></span>
</div>


<footer id="main-footer" onclick="OnOrderNowClicked()">
    PLACE ORDER
</footer>


<script type="text/javascript" src="https://js.stripe.com/v2/"></script>
<script type="text/javascript">
    Stripe.setPublishableKey('pk_live_CnJ0Jj3sAkBcHi8K037WpyAC');
</script>
<script>
    $('.btn-icon').click(function() {
        $(this).toggleClass('active');
    });
</script>

</body>
</html>